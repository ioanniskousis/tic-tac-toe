#!/usr/bin/env ruby
require_relative '../lib/game'
require_relative '../lib/interface'

game = Game.new
interface = Interface.new

loop do
  system('cls') || system('clear')
  lines = interface.draw(game.grid)
  lines.each { |line| puts line }
  if game.error_message.size.positive?
    puts game.error_message
    puts
    game.delete_error
  end

  puts "Your turn Player #{game.current_player}"

  if game.game_over == true
    puts
    if game.winner.positive?
      puts "Player #{game.winner} is the winner! Do you want to play again? (y)"
    else
      puts 'Game is Over! Do you want to play again? (y)'
    end
    choice = gets.chomp
    break unless choice.downcase == 'y'

    game.init
  else
    puts "Available cells #{game.available}"
    puts 'Enter Z to end the the game'
    choice = gets.chomp
    break if choice.downcase == 'z'

    game.check(choice.to_i)
  end
end
